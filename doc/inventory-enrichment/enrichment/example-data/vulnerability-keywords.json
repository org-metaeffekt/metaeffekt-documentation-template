{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "$id": "http://www.metaeffekt.com/schema/vulnerability-keywords.json",
  "title": "Vulnerability Keywords schema documentation",
  "oneOf": [
    {
      "type": "object",
      "properties": {
        "sets": {
          "type": "array",
          "title": "Keyword Sets",
          "description": "In order to allow for multiple keyword sets, each is represented by an array entry.",
          "items": {
            "type": "object",
            "title": "Keyword Set",
            "description": "A keyword set has to meet all keyword requirements (all, min, max) in order to be matched.",
            "additionalProperties": false,
            "additionalItems": false,
            "properties": {
              "name": {
                "type": "string",
                "title": "Keyword Set name"
              },
              "category": {
                "type": "string",
                "title": "Category"
              },
              "notes": {
                "type": "string",
                "title": "Extra notes"
              },
              "score": {
                "type": "number",
                "title": "Context Score",
                "description": "Used as context score in the Vulnerability Assessment Dashboard."
              },
              "all": {
                "type": "array",
                "title": "All",
                "description": "All keywords provided must match for the set to match.",
                "items": {
                  "type": "string",
                  "title": "Keyword"
                }
              },
              "none": {
                "type": "array",
                "title": "None",
                "description": "None of the keywords provided must match for the set to match.",
                "items": {
                  "type": "string",
                  "title": "Keyword"
                }
              },
              "status": {
                "$ref": "vulnerability-status.json"
              },
              "min": {
                "type": "array",
                "title": "Min",
                "description": "Sets with keyword sets each, that have to match a certain amount of times in order for the set to match.",
                "items": {
                  "type": "object",
                  "title": "Min keyword set",
                  "required": [
                    "amount",
                    "keywords"
                  ],
                  "properties": {
                    "amount": {
                      "type": "number",
                      "title": "Minimum amount",
                      "description": "The amount of times the keyword has to match in the string.",
                      "minimum": 0
                    },
                    "keywords": {
                      "type": "array",
                      "title": "Keywords",
                      "items": {
                        "type": "string",
                        "title": "Keyword"
                      }
                    }
                  }
                }
              },
              "max": {
                "type": "array",
                "title": "Max",
                "description": "Sets with keyword sets each, that must not match more than a certain amount of times in order for the set to match.",
                "items": {
                  "type": "object",
                  "title": "Max keyword set",
                  "required": [
                    "amount",
                    "keywords"
                  ],
                  "properties": {
                    "amount": {
                      "type": "number",
                      "title": "Maximum amount",
                      "description": "The amount of times the keyword can match in the string.",
                      "minimum": 0
                    },
                    "keywords": {
                      "type": "array",
                      "title": "Keywords",
                      "items": {
                        "type": "string",
                        "title": "Keyword"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "null"
    }
  ]
}