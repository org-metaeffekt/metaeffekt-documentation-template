{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "$id": "http://www.metaeffekt.com/schema/vulnerability-status.json",
  "type": "object",
  "title": "Vulnerability Status schema documentation",
  "additionalProperties": false,
  "additionalItems": false,
  "properties": {
    "affects": {
      "type": "object",
      "title": "Vulnerabilities/CPE affected by file",
      "description": "Specifies what vulnerabilities or CPE should be affected by this status file. If more than one file applies to the same vulnerability, a random one will be selected.",
      "additionalProperties": false,
      "additionalItems": false,
      "minProperties": 1,
      "maxProperties": 3,
      "properties": {
        "cve": {
          "type": "array",
          "title": "Affected Vulnerability-IDs",
          "description": "All Vulnerabilities contained in this list will have this status file applied. If custom vulnerabilities are defined, their IDs can be used as well.",
          "items": {
            "type": "string",
            "title": "A Vulnerability-ID"
          }
        },
        "cpe": {
          "type": "array",
          "title": "Affected CPEs",
          "description": "All Vulnerabilities with CPE version 2.0 or 3.x contained in this list will have this status file applied.",
          "items": {
            "type": "string",
            "title": "A CPE 2.0 or 3.x string"
          }
        },
        "cwe": {
          "type": "array",
          "title": "Affected CWEs",
          "description": "All Vulnerabilities with a CWE from this list will have this status file applied.",
          "items": {
            "type": "string",
            "title": "A CPE 2.0 or 3.x string"
          }
        }
      }
    },
    "title": {
      "type": "string",
      "title": "Vulnerability Title",
      "description": "This title will be displayed in the Vulnerability Assessment Dashboard and the Vulnerability Report."
    },
    "scope": {
      "type": "string",
      "title": "Vulnerability Scope",
      "enum": [
        "artifact",
        "inventory"
      ],
      "description": "Default value: 'artifact'. If set to 'inventory', the status is applied to all vulnerabilities in the inventory. A note with the status will also be included in the 'Info' sheet."
    },
    "cvssV2": {
      "type": "string",
      "title": "Modified CVSS 2.0 vector",
      "description": "This vector will be applied to the vulnerabilities default CVSS:2.0 vector and stored as modified vector.",
      "pattern": "^(CVSS:2\\.\\d/)?((AV|AC|Au|C|I|A|E|RL|RC|CDP|TD|CR|IR|AR):[^/]+(/|$))+$"
    },
    "cvssV3": {
      "type": "string",
      "title": "Modified CVSS 3.x vector",
      "description": "This vector will be applied to the vulnerabilities default CVSS:3.x vector and stored as modified vector.",
      "pattern": "^(CVSS:3\\.\\d/)?((AV|AC|PR|UI|S|C|I|A|E|RL|RC|MAV|MAC|MPR|MUI|MS|MC|MI|MA|CR|IR|AR):[^/]+(/|$))+$"
    },
    "reported": {
      "type": "object",
      "title": "Reported by",
      "description": "Specifies the timestamp and person that requested this file to be accepted.",
      "additionalProperties": false,
      "additionalItems": false,
      "minProperties": 1,
      "properties": {
        "by": {
          "type": "string",
          "title": "Reporter"
        },
        "date": {
          "type": "string",
          "title": "Report date"
        }
      }
    },
    "accepted": {
      "type": "object",
      "title": "Accepted by",
      "description": "Specifies the timestamp and person that accepted this file.",
      "additionalProperties": false,
      "additionalItems": false,
      "minProperties": 1,
      "properties": {
        "by": {
          "type": "string",
          "title": "Accepter"
        },
        "date": {
          "type": "string",
          "title": "Accept date"
        }
      }
    },
    "history": {
      "type": "array",
      "title": "Status history",
      "description": "A list of status entries, each specifying a step in the escalation or resolution of the affected vulnerabilities.",
      "items": {
        "type": "object",
        "title": "Status History entry",
        "additionalProperties": false,
        "additionalItems": false,
        "minProperties": 1,
        "properties": {
          "status": {
            "type": "string",
            "title": "Vulnerability Status",
            "oneOf": [
              {
                "enum": [
                  "applicable",
                  "not applicable",
                  "insignificant",
                  "void"
                ]
              }
            ]
          },
          "rationale": {
            "type": "string",
            "title": "Rationale"
          },
          "risk": {
            "type": "string",
            "title": "Risk"
          },
          "measures": {
            "type": "string",
            "title": "Measures"
          },
          "score": {
            "type": [
              "number",
              "integer"
            ],
            "title": "Context Score",
            "description": "Used as context score in the Vulnerability Assessment Dashboard."
          },
          "author": {
            "type": "string",
            "title": "Author",
            "description": "The author of the status history entry."
          },
          "date": {
            "type": "string",
            "title": "Last updated"
          },
          "labels": {
            "type": "object",
            "title": "Feature Labels",
            "description": "Used to exclude specific status entries. Feature Labels can be provided when executing the build step. If include labels are provided, at least one must be set. None of the exclude labels may be set.",
            "additionalProperties": false,
            "additionalItems": false,
            "minProperties": 1,
            "properties": {
              "includes": {
                "type": "array",
                "title": "Include Labels",
                "description": "At least one include label must be set.",
                "items": {
                  "type": "string",
                  "title": "Include Labels"
                }
              },
              "excludes": {
                "type": "array",
                "title": "The excludes Schema",
                "description": "None of the exclude label must be set.",
                "items": {
                  "type": "string",
                  "title": "Exclude Labels"
                }
              }
            }
          }
        }
      }
    },
    "reviewed": {
      "type": "array",
      "title": "Reviewed Advisories",
      "description": "Reviewed advisory identifiers can be provided to mark them as reviewed. A description can be provided.",
      "items": {
        "anyOf": [
          {
            "type": "string",
            "description": "An advisory ID optionally followed by a description in brackets.",
            "pattern": "^[^()]+(?:\\([^)]+\\))?$"
          },
          {
            "type": "object",
            "description": "An id and optionally a comment field.",
            "additionalProperties": false,
            "additionalItems": false,
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "type": "string",
                "title": "Advisory ID"
              },
              "comment": {
                "type": "string",
                "title": "Comment"
              }
            }
          }
        ]
      }
    },
    "active": {
      "type": "boolean",
      "title": "Status file active flag",
      "description": "Whether to use or skip this file during enrichment."
    }
  }
}