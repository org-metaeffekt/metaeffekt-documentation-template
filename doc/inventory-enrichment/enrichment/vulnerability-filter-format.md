> [Vulnerability Monitoring](../inventory-enrichment-overview.md) > [Inventory Enrichment](inventory-enrichment.md) >
> Vulnerability Filter

# Vulnerability Filter

Vulnerability filters, as used by the
[`vulnerabilityAssessmentDashboardEnrichment`](steps.md#vulnerability-assessment-dashboard-vad) and
[`vulnerabilityFilterEnrichment`](steps.md#vulnerability-filter) steps, are used to filter out vulnerabilities using an
expression string that is evaluated per vulnerability.

## Examples

```
attribute name contains 2020

[score unmodified overall max >= 9.0] or [attribute created > 2020-01-04]

[attribute cwe contains CWE-202] or [[attribute created > 2022-12-01] and [score modified overall max > [7.0 + 1.1]]]
```

## Format

The format allows to combine nested expressions using joining operators like `and` and `or`. Every nesting layer that
introduces it's own joining operator must be enclosed in `[]` square brackets. The following operators are supported:

- boolean operators: `and`, `or`, `xor`, `nand`, `nor`, `xnor`, `implies`
- arithmetic operators: `+`, `-`, `*`, `/`, `%`, `^`
- comparison operators: `>`, `>=`, `<`, `<=`, `==`, `!=`, `contains`, `matches`

Functions are called without `()` parentheses and without `,` commas between arguments. The following functions are
supported as of now:

- `attribute <attribute-name>`: returns the value of the attribute on the vulnerability with the given name. Available
  attributes are: `name`, `description`, `updated`, `created`, `cwe`, `source`
- `score <vector-type> <score> <version-selector>`: returns the value of a CVSS score.
    - `<vector-type>`: `unmodified`, `modified`
    - `<score>`: `overall`, `base`, `temporal`, `environmental`
    - `<version-selector>`: `v2`, `v3`, `max`, `min`, `latest`

The ` ` spaces between the function name and the arguments, the operators and brackets are required.

## Values

Values are parsed dynamically, depending on the context (argument, comparison, ...).

- boolean: `true`, `false`
- numbers: anything that can be parsed as a double value (e.g. `1.0`, `1`, `-5`)
- strings: `"` quotes are not required when the string does not contain spaces. If the string contains spaces, it must
  be
  enclosed in `"` quotes.
- dates: `yyyy-MM-dd` format, e.g. `2020-01-01`

## Full example

Vulnerability:

- name: `CVE-2020-1234`
- cvss v2: `AV:N/AC:L/Au:S/C:N/I:P/A:C/E:POC/RL:W/RC:UR/CDP:L/TD:M/CR:M/IR:M/AR:L` (overall: `3.9`)
- cvss v3: `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H` (overall: `9.8`)
- update date: `2020-01-05` (`1578178800000`)

Matching expression:

- `5 > 2`
- `[score unmodified overall max >= [7.5 + 1]] or [attribute name contains 2020]`
- `attribute name contains 2020`
- `score unmodified overall v3 >= 6`
- `attribute updated >= 2020-01-04`
- `attribute updated == 2020-01-05`
- `[score unmodified overall max >= 9.0] or [attribute created > 2020-01-04]` (does not have `created` date, but is
  combined with `or` operator)
- `[score unmodified overall max >= 9.0] and [attribute updated > 2020-01-04]`

Non-matching expression:

- `name contains 2020` (function call without `attribute` prefix, is parsed as string `"name"`)
- `attribute name contains 2021` (wrong year)
- `score unmodified overall v2 >= 6` (score is lower than `6`)
- `attribute updated >= 2020-01-06` (date is lower than `2020-01-06`)
- `[score unmodified overall max >= 9.0] and [attribute created > 2020-01-04]` (does not have `created` date and is
  combined with `and` operator)
